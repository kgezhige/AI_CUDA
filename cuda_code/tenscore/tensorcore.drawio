<mxfile host="app.diagrams.net" agent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/135.0.0.0 Safari/537.36 Edg/135.0.0.0" version="26.2.12">
  <diagram name="第 1 页" id="tvzfm7MFEGmpljqmTSRY">
    <mxGraphModel dx="793" dy="516" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1169" pageHeight="827" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="WmLL5lV2OyapyfxBnzE0-94" value="&lt;span&gt;warp(1,3)&lt;/span&gt;" style="rounded=0;whiteSpace=wrap;html=1;fontSize=6;" vertex="1" parent="1">
          <mxGeometry x="290" y="440" width="50" height="10" as="geometry" />
        </mxCell>
        <mxCell id="WmLL5lV2OyapyfxBnzE0-1" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="125" y="70" width="60" height="120" as="geometry" />
        </mxCell>
        <mxCell id="WmLL5lV2OyapyfxBnzE0-2" value="M=1024" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=6;" vertex="1" parent="1">
          <mxGeometry x="85" y="110" width="50" height="20" as="geometry" />
        </mxCell>
        <mxCell id="WmLL5lV2OyapyfxBnzE0-3" value="K=512" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=6;" vertex="1" parent="1">
          <mxGeometry x="155" y="55" width="40" height="20" as="geometry" />
        </mxCell>
        <mxCell id="WmLL5lV2OyapyfxBnzE0-4" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="205" y="110" width="30" height="60" as="geometry" />
        </mxCell>
        <mxCell id="WmLL5lV2OyapyfxBnzE0-5" value="K=512" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=6;" vertex="1" parent="1">
          <mxGeometry x="205" y="130" width="40" height="20" as="geometry" />
        </mxCell>
        <mxCell id="WmLL5lV2OyapyfxBnzE0-6" value="N=128" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=6;" vertex="1" parent="1">
          <mxGeometry x="200" y="165" width="40" height="20" as="geometry" />
        </mxCell>
        <mxCell id="WmLL5lV2OyapyfxBnzE0-7" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="255" y="70" width="30" height="120" as="geometry" />
        </mxCell>
        <mxCell id="WmLL5lV2OyapyfxBnzE0-8" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#FFF0EB;" vertex="1" parent="1">
          <mxGeometry x="125" y="70" width="10" height="10" as="geometry" />
        </mxCell>
        <mxCell id="WmLL5lV2OyapyfxBnzE0-9" value="" style="endArrow=classic;html=1;rounded=0;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="125" y="70" as="sourcePoint" />
            <mxPoint x="175" y="20" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="WmLL5lV2OyapyfxBnzE0-10" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#FFF0EB;" vertex="1" parent="1">
          <mxGeometry x="185" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="WmLL5lV2OyapyfxBnzE0-11" value="16" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=6;" vertex="1" parent="1">
          <mxGeometry x="205" y="5" width="30" height="20" as="geometry" />
        </mxCell>
        <mxCell id="WmLL5lV2OyapyfxBnzE0-12" value="16" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=6;" vertex="1" parent="1">
          <mxGeometry x="185" y="25" width="30" height="20" as="geometry" />
        </mxCell>
        <mxCell id="WmLL5lV2OyapyfxBnzE0-13" value="A" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="140" y="45" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="WmLL5lV2OyapyfxBnzE0-14" value="B" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="205" y="80" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="WmLL5lV2OyapyfxBnzE0-15" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#FFF0EB;" vertex="1" parent="1">
          <mxGeometry x="255" y="70" width="10" height="10" as="geometry" />
        </mxCell>
        <mxCell id="WmLL5lV2OyapyfxBnzE0-16" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#FFF0EB;" vertex="1" parent="1">
          <mxGeometry x="205" y="110" width="10" height="10" as="geometry" />
        </mxCell>
        <mxCell id="WmLL5lV2OyapyfxBnzE0-17" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#E4FFF0;" vertex="1" parent="1">
          <mxGeometry x="125" y="180" width="30" height="10" as="geometry" />
        </mxCell>
        <mxCell id="WmLL5lV2OyapyfxBnzE0-18" value="" style="endArrow=classic;html=1;rounded=0;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="140" y="185" as="sourcePoint" />
            <mxPoint x="190" y="230" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="WmLL5lV2OyapyfxBnzE0-19" value="block (0,0)" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#E4FFF0;fontSize=8;strokeColor=light-dark(#000000,#707070);opacity=50;" vertex="1" parent="1">
          <mxGeometry x="185" y="240" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="WmLL5lV2OyapyfxBnzE0-20" value="4" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=8;" vertex="1" parent="1">
          <mxGeometry x="300" y="250" width="30" height="20" as="geometry" />
        </mxCell>
        <mxCell id="WmLL5lV2OyapyfxBnzE0-21" value="32" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=8;" vertex="1" parent="1">
          <mxGeometry x="95" y="260" width="30" height="20" as="geometry" />
        </mxCell>
        <mxCell id="WmLL5lV2OyapyfxBnzE0-22" value="" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="135" y="70" width="50" height="10" as="geometry" />
        </mxCell>
        <mxCell id="WmLL5lV2OyapyfxBnzE0-23" value="" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="205" y="120" width="10" height="50" as="geometry" />
        </mxCell>
        <mxCell id="WmLL5lV2OyapyfxBnzE0-26" value="" style="endArrow=classic;html=1;rounded=0;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="275" y="70" as="sourcePoint" />
            <mxPoint x="225" y="30" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="WmLL5lV2OyapyfxBnzE0-27" value="&lt;font style=&quot;font-size: 8px;&quot;&gt;大概方法是C中的每一个16，16的小块，由A的行与B的列矩阵相乘得出。&lt;br&gt;所以要得知A小块内存位置（左上角位置），和B&lt;/font&gt;&lt;span style=&quot;font-size: 8px;&quot;&gt;小块, 调用mma_sync即可。&lt;/span&gt;&lt;div&gt;&lt;span style=&quot;font-size: 8px;&quot;&gt;而16，16的小块的tensorcore由一个warp（32线程）构成。所以要根据线程寻找对应的warpid，然后通过warp id 加载AB小子块，进行乘法和加法。&lt;/span&gt;&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="270" y="15" width="310" height="55" as="geometry" />
        </mxCell>
        <mxCell id="WmLL5lV2OyapyfxBnzE0-28" value="C" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="265" y="40" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="WmLL5lV2OyapyfxBnzE0-32" value="&lt;div style=&quot;text-align: left;&quot;&gt;&lt;span style=&quot;font-size: 7px; background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;这里线程块大小为 dim3 threadsPerBlock(32, 4),&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;&lt;span style=&quot;font-size: 7px;&quot;&gt;所以t.x in (0,31)&amp;nbsp; t.y in (0,3) ,&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;&lt;span style=&quot;font-size: 7px;&quot;&gt;代码为&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;div style=&quot;text-align: left;&quot;&gt;&lt;span style=&quot;font-size: 7px; text-wrap-mode: nowrap; background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;int warpM = (blockIdx.x * blockDim.x + threadIdx.x) / 32; // 每个 warp 处理一个 16x16 子矩阵&lt;/span&gt;&lt;/div&gt;&lt;span style=&quot;font-size: 7px; text-wrap-mode: nowrap;&quot;&gt;&lt;div style=&quot;text-align: left;&quot;&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;int warpN = (blockIdx.y * blockDim.y + threadIdx.y);&lt;/span&gt;&lt;/div&gt;&lt;/span&gt;&lt;div style=&quot;text-align: left;&quot;&gt;&lt;span style=&quot;font-size: 7px; text-wrap-mode: nowrap;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;span style=&quot;font-size: 7px; text-wrap-mode: nowrap;&quot;&gt;&lt;div style=&quot;text-align: left;&quot;&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;// 每个 warp 负责 M 和 N 方向上的一个 16x16 子矩阵&lt;/span&gt;&lt;/div&gt;&lt;/span&gt;&lt;span style=&quot;font-size: 7px; text-wrap-mode: nowrap;&quot;&gt;&lt;div style=&quot;text-align: left;&quot;&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;int row_offset = warpM * 16;&lt;/span&gt;&lt;/div&gt;&lt;/span&gt;&lt;span style=&quot;font-size: 7px; text-wrap-mode: nowrap;&quot;&gt;&lt;div style=&quot;text-align: left;&quot;&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;int col_offset = warpN * 16;&lt;/span&gt;&lt;/div&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;&lt;span style=&quot;font-size: 7px;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="25" y="270" width="290" height="110" as="geometry" />
        </mxCell>
        <mxCell id="WmLL5lV2OyapyfxBnzE0-33" value="// 初始化累加器&#xa;    nvcuda::wmma::fill_fragment(acc_frag, 0.0f);&#xa;&#xa;    // 沿 K 维度分块&#xa;    for (int k = 0; k &lt; K; k += 16) {&#xa;        // 检查边界，确保不越界&#xa;        if (row_offset &lt; M &amp;&amp; col_offset &lt; N &amp;&amp; k &lt; K) {&#xa;            // 加载 A 的子矩阵 (row_offset, k)&#xa;            nvcuda::wmma::load_matrix_sync(a_frag, a + row_offset * K + k, K);&#xa;            // 加载 B 的子矩阵 (k, col_offset)&#xa;            nvcuda::wmma::load_matrix_sync(b_frag, b + k * N + col_offset, N);&#xa;            // 执行矩阵乘法&#xa;            nvcuda::wmma::mma_sync(acc_frag, a_frag, b_frag, acc_frag);&#xa;        }&#xa;    }&#xa;矩阵乘法 C[m][n] = A[m][0]*B[0][n] + A[m][1]*B[1][n] + ... A[m][k]*B[k][n]&#xa;只要找到A[m][k]和B[k][n]的地址（左上角顶点），load_matrix_sync就能加载出16x16小块&#xa;如上图只要知道A[0][16]，B[16][0]load_matrix_sync就能加载出黄色16x16小块&#xa;关于二维转一维，矩阵中都是按照行或者列存储的。&#xa;A[row,col]  -&gt; A[row *(每行的元素) + col ) 这就是二维转一维，&#xa;之前row和col已经乘过16，转化为真实的元素位置&#xa;&#xa;" style="text;fontSize=9;" vertex="1" parent="1">
          <mxGeometry x="480" y="100" width="330" height="350" as="geometry" />
        </mxCell>
        <mxCell id="WmLL5lV2OyapyfxBnzE0-34" value="&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;color: light-dark(rgb(79, 214, 98), rgb(255, 255, 255));&quot;&gt;&lt;span style=&quot;font-size: 7px;&quot;&gt;举例分析：&lt;/span&gt;&lt;span style=&quot;font-size: 7px; background-color: transparent;&quot;&gt;b.x=0,b.y=0&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;font-size: 8px; text-align: center; background-color: transparent;&quot;&gt;block (0,0)&lt;/span&gt;&lt;span style=&quot;background-color: transparent; font-size: 7px;&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;color: light-dark(rgb(79, 214, 98), rgb(255, 255, 255));&quot;&gt;&lt;span style=&quot;font-size: 7px; background-color: transparent;&quot;&gt;t.x = (0：31)&amp;nbsp; &lt;/span&gt;&lt;span style=&quot;font-size: 7px; background-color: transparent;&quot;&gt;t.y = 0&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;font-size: 7px; text-wrap-mode: nowrap; background-color: transparent;&quot;&gt;warp(M,N) = (0,0)&amp;nbsp;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;color: light-dark(rgb(79, 214, 98), rgb(255, 255, 255));&quot;&gt;&lt;span style=&quot;background-color: transparent; font-size: 7px;&quot;&gt;block的第一行&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;color: light-dark(rgb(79, 214, 98), rgb(255, 255, 255));&quot;&gt;&lt;span style=&quot;background-color: transparent; font-size: 7px;&quot;&gt;t.x = (0,31)&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;background-color: transparent; font-size: 7px;&quot;&gt;t.y = 1&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;background-color: transparent; text-wrap-mode: nowrap; font-size: 7px;&quot;&gt;warp(M,N) = (0,1)&amp;nbsp;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;div&gt;&lt;font style=&quot;color: light-dark(rgb(79, 214, 98), rgb(255, 255, 255));&quot;&gt;&lt;span style=&quot;font-size: 7px; background-color: transparent;&quot;&gt;t.x = (0,31)&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;font-size: 7px; background-color: transparent;&quot;&gt;t.y = 2&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;font-size: 7px; text-wrap-mode: nowrap; background-color: transparent;&quot;&gt;warp(M,N) = (0,2)&amp;nbsp;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;color: light-dark(rgb(79, 214, 98), rgb(255, 255, 255));&quot;&gt;&lt;span style=&quot;background-color: transparent; font-size: 7px;&quot;&gt;t.x = (0,31)&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;background-color: transparent; font-size: 7px;&quot;&gt;t.y = 3&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;background-color: transparent; text-wrap-mode: nowrap; font-size: 7px;&quot;&gt;warp(M,N) = (0,3)&lt;/span&gt;&lt;/font&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); text-wrap-mode: nowrap; font-size: 7px;&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); text-wrap-mode: nowrap; font-size: 7px;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;font style=&quot;color: rgb(84, 199, 196);&quot;&gt;&lt;span style=&quot;font-size: 7px;&quot;&gt;举例分析：&lt;/span&gt;&lt;span style=&quot;font-size: 7px; background-color: transparent;&quot;&gt;b.x=0,b.y=1&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;font-size: 8px; text-align: center; background-color: transparent;&quot;&gt;block (0,1)&lt;/span&gt;&lt;span style=&quot;background-color: transparent; font-size: 7px;&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;color: rgb(84, 199, 196);&quot;&gt;&lt;span style=&quot;font-size: 7px; background-color: transparent;&quot;&gt;t.x = (0,31)&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;font-size: 7px; background-color: transparent;&quot;&gt;t.y = 0&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;font-size: 7px; text-wrap-mode: nowrap; background-color: transparent;&quot;&gt;warp(M,N) = (0,4)&amp;nbsp;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;color: rgb(84, 199, 196);&quot;&gt;&lt;span style=&quot;background-color: transparent; font-size: 7px;&quot;&gt;t.x = (0,31)&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;background-color: transparent; font-size: 7px;&quot;&gt;t.y = 1&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;background-color: transparent; text-wrap-mode: nowrap; font-size: 7px;&quot;&gt;warp(M,N) = (0,5)&amp;nbsp;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;font style=&quot;color: rgb(84, 199, 196);&quot;&gt;&lt;span style=&quot;font-size: 7px; background-color: transparent;&quot;&gt;t.x = (0,31)&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;font-size: 7px; background-color: transparent;&quot;&gt;t.y = 3&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;font-size: 7px; text-wrap-mode: nowrap; background-color: transparent;&quot;&gt;warp(M,N) = (0,6)&amp;nbsp;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;color: rgb(84, 199, 196);&quot;&gt;&lt;span style=&quot;background-color: transparent; font-size: 7px;&quot;&gt;t.x = (0,31)&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;background-color: transparent; font-size: 7px;&quot;&gt;t.y = 4&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;background-color: transparent; text-wrap-mode: nowrap; font-size: 7px;&quot;&gt;warp(M,N) = (0,7)&amp;nbsp;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); text-wrap-mode: nowrap; font-size: 7px;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;font style=&quot;color: rgb(82, 102, 191);&quot;&gt;&lt;span style=&quot;font-size: 7px;&quot;&gt;举例分析：&lt;/span&gt;&lt;span style=&quot;font-size: 7px; background-color: transparent;&quot;&gt;b.x=0,b.y=2&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;font-size: 8px; text-align: center; background-color: transparent;&quot;&gt;block (0,2)&lt;/span&gt;&lt;span style=&quot;background-color: transparent; font-size: 7px;&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;color: rgb(82, 102, 191);&quot;&gt;&lt;span style=&quot;font-size: 7px; background-color: transparent;&quot;&gt;t.x = (0,31)&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;font-size: 7px; background-color: transparent;&quot;&gt;t.y = 0&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;font-size: 7px; text-wrap-mode: nowrap; background-color: transparent;&quot;&gt;warp(M,N) = (0,8) ，&lt;/span&gt;&lt;span style=&quot;background-color: transparent; font-size: 7px; text-wrap-mode: nowrap;&quot;&gt;row = 0，col=128&amp;nbsp;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;color: rgb(82, 102, 191);&quot;&gt;&lt;span style=&quot;background-color: transparent; font-size: 7px;&quot;&gt;t.x = (0,31)&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;background-color: transparent; font-size: 7px;&quot;&gt;t.y = 1&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;background-color: transparent; text-wrap-mode: nowrap; font-size: 7px;&quot;&gt;warp(M,N) = (0,9)&amp;nbsp; &amp;nbsp;不满足&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;background-color: transparent; font-size: 7px; text-wrap-mode: nowrap;&quot;&gt;col_offset &amp;lt; N（128）&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;" style="text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="80" y="380" width="125" height="280" as="geometry" />
        </mxCell>
        <mxCell id="WmLL5lV2OyapyfxBnzE0-35" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="240" y="420" width="200" height="180" as="geometry" />
        </mxCell>
        <mxCell id="WmLL5lV2OyapyfxBnzE0-36" value="&lt;font&gt;warp(0,0)&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;fontSize=6;" vertex="1" parent="1">
          <mxGeometry x="240" y="420" width="50" height="10" as="geometry" />
        </mxCell>
        <mxCell id="WmLL5lV2OyapyfxBnzE0-39" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#FFF79A;" vertex="1" parent="1">
          <mxGeometry x="265" y="70" width="10" height="10" as="geometry" />
        </mxCell>
        <mxCell id="WmLL5lV2OyapyfxBnzE0-43" value="&lt;span&gt;warp(0,1)&lt;/span&gt;" style="rounded=0;whiteSpace=wrap;html=1;fontSize=6;" vertex="1" parent="1">
          <mxGeometry x="240" y="430" width="50" height="10" as="geometry" />
        </mxCell>
        <mxCell id="WmLL5lV2OyapyfxBnzE0-44" value="&lt;span&gt;warp(0,2)&lt;/span&gt;" style="rounded=0;whiteSpace=wrap;html=1;fontSize=6;" vertex="1" parent="1">
          <mxGeometry x="240" y="440" width="50" height="10" as="geometry" />
        </mxCell>
        <mxCell id="WmLL5lV2OyapyfxBnzE0-45" value="&lt;span&gt;warp(0,3)&lt;/span&gt;" style="rounded=0;whiteSpace=wrap;html=1;fontSize=6;" vertex="1" parent="1">
          <mxGeometry x="240" y="450" width="50" height="10" as="geometry" />
        </mxCell>
        <mxCell id="WmLL5lV2OyapyfxBnzE0-46" value="&lt;font style=&quot;font-size: 8px;&quot;&gt;64个&lt;/font&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="275" y="110" width="40" height="30" as="geometry" />
        </mxCell>
        <mxCell id="WmLL5lV2OyapyfxBnzE0-47" value="&lt;font style=&quot;font-size: 8px;&quot;&gt;8个&lt;/font&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="250" y="165" width="40" height="30" as="geometry" />
        </mxCell>
        <mxCell id="WmLL5lV2OyapyfxBnzE0-48" value="256个线程（64个block）64个warp" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=8;" vertex="1" parent="1">
          <mxGeometry x="260" y="580" width="150" height="20" as="geometry" />
        </mxCell>
        <mxCell id="WmLL5lV2OyapyfxBnzE0-49" value="32个线程（8个 block）" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=8;" vertex="1" parent="1">
          <mxGeometry x="440" y="495" width="110" height="20" as="geometry" />
        </mxCell>
        <mxCell id="WmLL5lV2OyapyfxBnzE0-51" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=none;strokeColor=#42BA13;fontSize=6;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="240" y="420" width="50" height="40" as="geometry" />
        </mxCell>
        <mxCell id="WmLL5lV2OyapyfxBnzE0-53" value="&lt;span&gt;warp(0,4)&lt;/span&gt;" style="rounded=0;whiteSpace=wrap;html=1;fontSize=6;" vertex="1" parent="1">
          <mxGeometry x="240" y="460" width="50" height="10" as="geometry" />
        </mxCell>
        <mxCell id="WmLL5lV2OyapyfxBnzE0-54" value="&lt;span&gt;warp(0,5)&lt;/span&gt;" style="rounded=0;whiteSpace=wrap;html=1;fontSize=6;" vertex="1" parent="1">
          <mxGeometry x="240" y="470" width="50" height="10" as="geometry" />
        </mxCell>
        <mxCell id="WmLL5lV2OyapyfxBnzE0-55" value="warp(0,6)" style="rounded=0;whiteSpace=wrap;html=1;fontSize=6;" vertex="1" parent="1">
          <mxGeometry x="240" y="480" width="50" height="10" as="geometry" />
        </mxCell>
        <mxCell id="WmLL5lV2OyapyfxBnzE0-56" value="warp(0,7)" style="rounded=0;whiteSpace=wrap;html=1;fontSize=6;" vertex="1" parent="1">
          <mxGeometry x="240" y="490" width="50" height="10" as="geometry" />
        </mxCell>
        <mxCell id="WmLL5lV2OyapyfxBnzE0-57" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=none;strokeColor=#15BAB4;fontSize=6;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="240" y="460" width="50" height="40" as="geometry" />
        </mxCell>
        <mxCell id="WmLL5lV2OyapyfxBnzE0-59" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=none;strokeColor=light-dark(#000000,#707070);opacity=50;" vertex="1" parent="1">
          <mxGeometry x="185" y="240" width="120" height="10" as="geometry" />
        </mxCell>
        <mxCell id="WmLL5lV2OyapyfxBnzE0-60" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=none;strokeColor=light-dark(#000000,#707070);opacity=50;" vertex="1" parent="1">
          <mxGeometry x="185" y="250" width="120" height="10" as="geometry" />
        </mxCell>
        <mxCell id="WmLL5lV2OyapyfxBnzE0-61" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=none;strokeColor=light-dark(#000000,#707070);opacity=50;" vertex="1" parent="1">
          <mxGeometry x="185" y="260" width="120" height="10" as="geometry" />
        </mxCell>
        <mxCell id="WmLL5lV2OyapyfxBnzE0-62" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=none;strokeColor=light-dark(#000000,#707070);opacity=50;" vertex="1" parent="1">
          <mxGeometry x="185" y="270" width="120" height="10" as="geometry" />
        </mxCell>
        <mxCell id="WmLL5lV2OyapyfxBnzE0-63" value="这里warp(0,1)为warp(M,N),&lt;div&gt;代表子块中的row，col = （0，1）&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=8;" vertex="1" parent="1">
          <mxGeometry x="245" y="610" width="140" height="30" as="geometry" />
        </mxCell>
        <mxCell id="WmLL5lV2OyapyfxBnzE0-66" value="&lt;font&gt;warp(0,8)&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;fontSize=6;" vertex="1" parent="1">
          <mxGeometry x="240" y="500" width="50" height="10" as="geometry" />
        </mxCell>
        <mxCell id="WmLL5lV2OyapyfxBnzE0-67" value="&lt;span&gt;warp(0,9)&lt;/span&gt;" style="rounded=0;whiteSpace=wrap;html=1;fontSize=6;" vertex="1" parent="1">
          <mxGeometry x="240" y="510" width="50" height="10" as="geometry" />
        </mxCell>
        <mxCell id="WmLL5lV2OyapyfxBnzE0-68" value="&lt;span&gt;warp(0,10)&lt;/span&gt;" style="rounded=0;whiteSpace=wrap;html=1;fontSize=6;" vertex="1" parent="1">
          <mxGeometry x="240" y="520" width="50" height="10" as="geometry" />
        </mxCell>
        <mxCell id="WmLL5lV2OyapyfxBnzE0-69" value="&lt;span&gt;warp(0,11)&lt;/span&gt;" style="rounded=0;whiteSpace=wrap;html=1;fontSize=6;" vertex="1" parent="1">
          <mxGeometry x="240" y="530" width="50" height="10" as="geometry" />
        </mxCell>
        <mxCell id="WmLL5lV2OyapyfxBnzE0-70" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=none;strokeColor=#1842BA;fontSize=6;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="240" y="500" width="50" height="40" as="geometry" />
        </mxCell>
        <mxCell id="WmLL5lV2OyapyfxBnzE0-77" value="" style="shape=curlyBracket;whiteSpace=wrap;html=1;rounded=1;labelPosition=left;verticalLabelPosition=middle;align=right;verticalAlign=middle;" vertex="1" parent="1">
          <mxGeometry x="220" y="500" width="10" height="100" as="geometry" />
        </mxCell>
        <mxCell id="WmLL5lV2OyapyfxBnzE0-78" value="&lt;font style=&quot;font-size: 5px;&quot;&gt;这里大于C的子块宽度8&lt;/font&gt;&lt;div&gt;&lt;font style=&quot;font-size: 5px;&quot;&gt;不满足if&amp;nbsp;&lt;span style=&quot;text-align: left; background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;col_offset &amp;lt; N&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="10" y="590" width="70" height="40" as="geometry" />
        </mxCell>
        <mxCell id="WmLL5lV2OyapyfxBnzE0-79" value="&lt;font&gt;warp(1,0)&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;fontSize=6;" vertex="1" parent="1">
          <mxGeometry x="290" y="420" width="50" height="10" as="geometry" />
        </mxCell>
        <mxCell id="WmLL5lV2OyapyfxBnzE0-80" value="&lt;span&gt;warp(1,1)&lt;/span&gt;" style="rounded=0;whiteSpace=wrap;html=1;fontSize=6;" vertex="1" parent="1">
          <mxGeometry x="290" y="430" width="50" height="10" as="geometry" />
        </mxCell>
        <mxCell id="WmLL5lV2OyapyfxBnzE0-82" value="&lt;span&gt;warp(1,4)&lt;/span&gt;" style="rounded=0;whiteSpace=wrap;html=1;fontSize=6;" vertex="1" parent="1">
          <mxGeometry x="290" y="450" width="50" height="10" as="geometry" />
        </mxCell>
        <mxCell id="WmLL5lV2OyapyfxBnzE0-83" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=none;strokeColor=#E64EDF;fontSize=6;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="290" y="420" width="50" height="40" as="geometry" />
        </mxCell>
        <mxCell id="WmLL5lV2OyapyfxBnzE0-84" value="" style="endArrow=classic;html=1;rounded=0;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="223" y="429" as="sourcePoint" />
            <mxPoint x="230" y="440" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="WmLL5lV2OyapyfxBnzE0-85" value="&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;color: rgb(230, 78, 223);&quot;&gt;&lt;span style=&quot;font-size: 7px;&quot;&gt;举例分析：&lt;/span&gt;&lt;span style=&quot;font-size: 7px; background-color: transparent;&quot;&gt;b.x=1,b.y=0&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;font-size: 8px; text-align: center; background-color: transparent;&quot;&gt;block (1,0)&lt;/span&gt;&lt;span style=&quot;background-color: transparent; font-size: 7px;&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;color: rgb(230, 78, 223);&quot;&gt;&lt;span style=&quot;font-size: 7px; background-color: transparent;&quot;&gt;t.x = (0：31)&amp;nbsp; &lt;/span&gt;&lt;span style=&quot;font-size: 7px; background-color: transparent;&quot;&gt;t.y = 0&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;font-size: 7px; text-wrap-mode: nowrap; background-color: transparent;&quot;&gt;warp(M,N) = (1,0)&amp;nbsp;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;color: rgb(230, 78, 223);&quot;&gt;&lt;span style=&quot;background-color: transparent; font-size: 7px;&quot;&gt;t.x = (0,31)&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;background-color: transparent; font-size: 7px;&quot;&gt;t.y = 1&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;background-color: transparent; text-wrap-mode: nowrap; font-size: 7px;&quot;&gt;warp(M,N) = (1,1)&amp;nbsp;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;div&gt;&lt;font style=&quot;color: rgb(230, 78, 223);&quot;&gt;&lt;span style=&quot;font-size: 7px; background-color: transparent;&quot;&gt;t.x = (0,31)&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;font-size: 7px; background-color: transparent;&quot;&gt;t.y = 2&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;font-size: 7px; text-wrap-mode: nowrap; background-color: transparent;&quot;&gt;warp(M,N) = (1,2)&amp;nbsp;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;color: rgb(230, 78, 223);&quot;&gt;&lt;font style=&quot;&quot;&gt;&lt;span style=&quot;background-color: transparent; font-size: 7px;&quot;&gt;t.x = (0,31)&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;background-color: transparent; font-size: 7px;&quot;&gt;t.y = 3&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;background-color: transparent; text-wrap-mode: nowrap; font-size: 7px;&quot;&gt;warp(M,N) = (1,3)&lt;/span&gt;&lt;/font&gt;&lt;span style=&quot;background-color: transparent; text-wrap-mode: nowrap; font-size: 7px;&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: transparent; text-wrap-mode: nowrap; font-size: 7px;&quot;&gt;&lt;font style=&quot;color: rgb(230, 78, 223);&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;" style="text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="240" y="320" width="152.5" height="90" as="geometry" />
        </mxCell>
        <mxCell id="WmLL5lV2OyapyfxBnzE0-87" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=none;dashed=1;" vertex="1" parent="1">
          <mxGeometry x="230" y="413.5" width="220" height="91" as="geometry" />
        </mxCell>
        <mxCell id="WmLL5lV2OyapyfxBnzE0-88" value="" style="endArrow=classic;html=1;rounded=0;dashed=1;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="455" y="350" as="sourcePoint" />
            <mxPoint x="315" y="160" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="WmLL5lV2OyapyfxBnzE0-89" value="虚线框内为warp矩阵&lt;div&gt;转置后为（64，8）匹配C的子块形状&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=7;" vertex="1" parent="1">
          <mxGeometry x="360" y="380" width="140" height="30" as="geometry" />
        </mxCell>
        <mxCell id="WmLL5lV2OyapyfxBnzE0-90" value="&lt;font&gt;warp(64,0)&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;fontSize=6;" vertex="1" parent="1">
          <mxGeometry x="390" y="420" width="50" height="10" as="geometry" />
        </mxCell>
        <mxCell id="WmLL5lV2OyapyfxBnzE0-91" value="&lt;span&gt;warp(64,1)&lt;/span&gt;" style="rounded=0;whiteSpace=wrap;html=1;fontSize=6;" vertex="1" parent="1">
          <mxGeometry x="390" y="430" width="50" height="10" as="geometry" />
        </mxCell>
        <mxCell id="WmLL5lV2OyapyfxBnzE0-96" value="&lt;font&gt;warp(64,4)&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;fontSize=6;" vertex="1" parent="1">
          <mxGeometry x="390" y="460" width="50" height="10" as="geometry" />
        </mxCell>
        <mxCell id="WmLL5lV2OyapyfxBnzE0-97" value="&lt;span&gt;warp(64,5)&lt;/span&gt;" style="rounded=0;whiteSpace=wrap;html=1;fontSize=6;" vertex="1" parent="1">
          <mxGeometry x="390" y="470" width="50" height="10" as="geometry" />
        </mxCell>
        <mxCell id="WmLL5lV2OyapyfxBnzE0-98" value="&lt;span&gt;warp(64,7)&lt;/span&gt;" style="rounded=0;whiteSpace=wrap;html=1;fontSize=6;" vertex="1" parent="1">
          <mxGeometry x="390" y="490" width="50" height="10" as="geometry" />
        </mxCell>
        <mxCell id="WmLL5lV2OyapyfxBnzE0-99" value="&lt;span&gt;warp(64,6)&lt;/span&gt;" style="rounded=0;whiteSpace=wrap;html=1;fontSize=6;" vertex="1" parent="1">
          <mxGeometry x="390" y="480" width="50" height="10" as="geometry" />
        </mxCell>
        <mxCell id="WmLL5lV2OyapyfxBnzE0-100" value="&lt;font&gt;warp(64,2)&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;fontSize=6;" vertex="1" parent="1">
          <mxGeometry x="390" y="440" width="50" height="10" as="geometry" />
        </mxCell>
        <mxCell id="WmLL5lV2OyapyfxBnzE0-101" value="&lt;span&gt;warp(64,3)&lt;/span&gt;" style="rounded=0;whiteSpace=wrap;html=1;fontSize=6;" vertex="1" parent="1">
          <mxGeometry x="390" y="450" width="50" height="10" as="geometry" />
        </mxCell>
        <mxCell id="WmLL5lV2OyapyfxBnzE0-103" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#F8FF79;" vertex="1" parent="1">
          <mxGeometry x="135" y="70" width="10" height="10" as="geometry" />
        </mxCell>
        <mxCell id="WmLL5lV2OyapyfxBnzE0-104" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#F8FF79;" vertex="1" parent="1">
          <mxGeometry x="205" y="120" width="10" height="10" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
